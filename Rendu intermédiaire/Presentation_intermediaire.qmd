---
title: "Modelling the desensitization in patients awaiting transplantation"
author: "BREUZA Léonie, MAZET Matthias, OKADO Kento, VIGNAUD Enzo"
date: 12/19/2024
date-format: "DD MMMM YYYY"
format:
  revealjs: 
    slide-number: true
    chalkboard: 
      buttons: false
    preview-links: auto
    logo: images/Logo_UGA.png
    css: assets/style.css
    toc: true
    toc-depth: 4
    resources: images
    footer: "Tutored Project M1 SDS"
    header-includes: |
      <script src="assets/custom.js" type="application/javascript"></script>
    slide-level: 4
    responsive: TRUE
    center: TRUE
    width: 150%
    height: 150%
lang: "en"
---

## I - Introdution
### A) Context
<br>
20 000 Patients waiting for transplantation in France  
<br>
Hyperimmune patients :  
  - HLA antibodies = Human Leukocyte Antigen, making the distinction between self and non-self cells
  
  - more likely to reject transplatation  
<br>
Desensitivisation protocol :  
   - decrease the number of anti-HLA antibodies  
   - long and exhausting for patients


### B) Objectives
<br>

Very different immune profiles with great variability :
<br>

- HLA modelling as a function of covariates

<br>

-  Define optimized strategy of desensitization for patient

<br>

- Create an R shiny application : visualize antibodies and the immune system complexity


## II - Data overview

### A) Protocol
:::: {.columns}

::: {.column width="55%"}

<br>

- 10 patients


- 10 desimmunisation seances (immunoabsorptions) :

  - 2 weeks, 5 days per week

  - 2 samples : before and after the seance

  - Quantification of MFI : Mean Fluorescence Intensity, way of measuring anti-HLA presence in patients bodies

  - Goal : MFI under the 3000 threshold


- Grouped into 2 classes of antibodies (CLASS 1 and CLASS 2), 2 MFI by sampling


:::

::: {.column width="45%"}

<p align="center"> <img src="/images/Graph_data_overview.png"  height="500" width="1100"></p>

:::

::::

### B) Data description (longitudinal data)
<br>

The dataset contains :  
<br>

- 251 observations made on 10 individuals
<br>

- 34 variables :  
   - general informations about the treatment (date, beginning and ending time, ...) 
   - clinical informatiosn about the treatment (major epitote, locus type, class I MFI, class II MFI, prescribed plasma volume, treated plasma volume, ...)
   - informations about the patient (ID, sex, age, height, weight, number of pregnancy, ...) 

<br>


## III - Methodology

### A) Statistical model 
<br>
Pharmacokinetics studies : study of the absorption, distribution, metabolism and excretion of a compound by an organism.
<br>
Non-linear mixed effects models :  
    - repeated measurements  
    - fixed and random effects  
    - small sample size  
<br>
Tools : Monolix@lixsoft and R

---

Model :  
$$
y_{i} = f(\phi_i, v_i)+\epsilon_i \quad , \quad i=1,...,M
$$
$M$ number of patients  
$f$ function of group specific parameters vector $\phi_i$ and covariate vector $v_i$  
$\phi_i = A_i \beta + B b_i$ where $\beta$ is a vector of fixed effects and $b_i$ is a vectir of random effects associated with each patient  
$\epsilon_i$ random variable describing residual error  
<br>
Parameters to estimate :  
random/fixed effects $\phi_i$, covariate vectir $v_i$ and residual error $\epsilon_i$  
<br>
Model validation, protocol simulation


### B) Strategy
#### 1. Data management
- Base file : Excel file

- What we want : csv file for easier work later

- How : 1st R program to rectify and structure data

- NA values handling : replaced by the mean value of the patient

- Seance duration recalculation : check the hand written value

- Adding delta MFI calcul

image de structure souhaitée

<!-- 
- The variable names are quite difficult to exploit in R because they consists of two rows and small sentences,
we changed them to simple one or two words names with a prefix when necessary
- Data is written manually, there are a some mistypes and errors
- There are missing values, including some we have to complete to be able to do proper modeling
- Some rows aren't data and just additional information, we wanted to remove them

<p align="center"> <img src="/images/Data_cleaning_schema.png"  height="500" width="1100"></p> -->


#### 2. Descriptive statistics

#### 3. MFI modelling

<p align="center" display="table-cell" vertical-align="middle"> <img src="/images/MFIclasse1.png"  height="500" width="600"> <img src="/images/MFIclasse2.png"  height="500" width="600"> <img src="/images/MFIlegende.png"  height="150" width="100"> </p>

<br>
Class I MFI decreases at a good rate over time but classe II MFI seems to plateau.  
Some patients reach the 3000 threshold quickly.

#### 4. Shiny App


## IV - Future plan
### A) Schedule overview
Some of our remaining goals :

- Find the most suitable model
- Compare R's and Monolix's methods
- Create a Shiny application

```{mermaid}
gantt
   title Gantt diagram
   dateFormat  DD-MM-YYYY
   section Analyse des données
   Data cleaning : a1, 23-10-2024, 45d
   Data formatting : a2, 23-10-2024, 45d
   Univariate analyses : a3, 23-10-2024, 45d
   Bivariate analyses : a4, after a3, 20d
   Data vizualisation : a5, 23-10-2024, 45d
   section Intermediate presentation
   Support preparation : a6, 04-10-2024, 20-12-2024
   Project Management : a7, 21-10-2024, 20-12-2024
   Oral practice: a8, 09-12-2024, 20-12-2024
   section modelling
   Monolix software exploration : a9, after a3  , 50d
   R models research : a10, after a3, 50d
   Bibliographical study : a11, after a3, 100d
   MFI modelling : a12, after a9  , 50d
   section Final report
   Redaction : a13, after a8, 90d
   Numeric impacts course : a14, after a3, 40d
   Carbon Footprint study : a15, after a3, 100d
   Proofreading : a16, after a13, 30d
   section Final presentation
   Support preparation : a19, after a8, 50d
   Oral practice : a18, after a12, 30d
   section Shiny app developpment
   Application construction : a19, after a12  , 30d
```

### B) Possible scenarios

:::: {.columns}

::: {.column width="65%"}
<br>
There are 3 possible outcomes for our project :

- Best case : every task is done, the models and the shiny application 
- Most likely case : the modelling is made but not the app
- Worst case: the model created isn't satisfying enough and the application isn't done 
:::

::: {.column width="35%"}
<br>
<br>
```{mermaid}
%%{init: {"quadrantChart": {"pointLabelFontSize": 10, 
                            "pointTextPadding": 10,
                            "pointRadius": 4}, 
          "themeVariables": {"quadrant1Fill": "tomato",
                             "quadrant2Fill": "orange", 
                             "quadrant3Fill": "lightgreen", 
                             "quadrant4Fill": "orange"}
    }}%%
quadrantChart
    title Risk matrix
    x-axis "Low consequences" --> "High consequences"
    y-axis "Low likelihood" --> "High likelihood"
    "Wrong files' versions": [0.25, 0.65]
    "Missing students": [0.3, 0.9]
    "Team conflicts": [0.9, 0.2]
    "Changing in backers' needs": [0.85, 0.85]
    "Delayed schedule": [0.6, 0.7]
    "Files' loss": [0.65, 0.23]
    "Legal issues (plagiarism)": [0.7, 0.12]
    "Non functional study": [0.89, 0.07]
    "Response fail": [0.9, 0.3]
```

:::

::::



